<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admintrastor</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <link rel="stylesheet" href=" /stylesheets/index.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
</head>

<body>
  <header class="p-3 mb-3 border-bottom">
    <div class="container">
      <div class="d-flex flex-wrap align-items-sm-start justify-content-lg-start justify-content-lg-start">
        <p style="font-size: 30px; align-items:flex-start;">TRANG QUẢN LÝ</p>
        <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">

        </ul>
        <div class="dropdown text-end">
          <a href="#" class="d-block link-dark text-decoration-none dropdown-toggle" data-bs-toggle="dropdown"
            aria-expanded="false">

            <img src="<%= ava ? ava : '/images/profile-icon.png' %>" alt="mdo" width="32" height="32"
              class="rounded-circle">
          </a>
          <ul class="dropdown-menu text-small">
            <li><a class="dropdown-item" href="./admin-profile/<%= user.id %> ">Hồ sơ</a></li>
            <li><a class="dropdown-item" href="/logout">Đăng xuất</a></li>
          </ul>
        </div>
        <div>&nbsp&nbsp&nbsp</div>
        <p class="admin">
          <%= user.username%>
        </p>

      </div>
    </div>
  </header>


  <div class="container-fluid">
    <div class="row flex-nowrap">
      <div class="col-auto col-md-3 col-xl-2 px-sm-2 px-0 bg-white">
        <div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-2 text-white min-vh-100">
          <a href="/static" class="d-flex align-items-center pb-3 mb-md-0 me-md-auto text-black text-decoration-none">
            <span class="fs-5 d-none d-sm-inline">Menu</span>
          </a>
          <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-center align-items-sm-start" id="menu">
            <li class="nav-item">
              <a href="./users-manage" class="nav-link align-middle px-0 text-black">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people"
                  viewBox="0 0 16 16">
                  <path
                    d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z" />
                </svg><i class="fs-4 bi-house"></i><span class="ms-1 d-none d-sm-inline">Quản lí người dùng</span>
              </a>
            </li>
            <li>
              <a href="./product-manage" class="nav-link px-0 align-middle text-black">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bag"
                  viewBox="0 0 16 16">
                  <path
                    d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z" />
                </svg><i class="fs-4 bi-table"></i> <span class="ms-1 d-none d-sm-inline">Quản lí sản phẩm</span></a>
            </li>
            <li>
              <a href="./orders-manage" class="nav-link px-0 align-middle text-black">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-cart-check" viewBox="0 0 16 16">
                  <path
                    d="M11.354 6.354a.5.5 0 0 0-.708-.708L8 8.293 6.854 7.146a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z" />
                  <path
                    d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1H.5zm3.915 10L3.102 4h10.796l-1.313 7h-8.17zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
                </svg><i class="fs-4 bi-table"></i> <span class="ms-1 d-none d-sm-inline">Quản lí đơn đặt
                  hàng</span></a>
            </li>
            <li>
              <a href="./origin-manage" class="nav-link px-0 align-middle text-black">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-box-seam-fill" viewBox="0 0 16 16">
                  <path fill-rule="evenodd"
                    d="M15.528 2.973a.75.75 0 0 1 .472.696v8.662a.75.75 0 0 1-.472.696l-7.25 2.9a.75.75 0 0 1-.557 0l-7.25-2.9A.75.75 0 0 1 0 12.331V3.669a.75.75 0 0 1 .471-.696L7.443.184l.01-.003.268-.108a.75.75 0 0 1 .558 0l.269.108.01.003 6.97 2.789ZM10.404 2 4.25 4.461 1.846 3.5 1 3.839v.4l6.5 2.6v7.922l.5.2.5-.2V6.84l6.5-2.6v-.4l-.846-.339L8 5.961 5.596 5l6.154-2.461L10.404 2Z" />
                </svg><i class="fs-4 bi-table"></i> <span class="ms-1 d-none d-sm-inline">Quản lí nơi
                  sản xuất</span></a>
            </li>
            <li>
              <a href="./type-manage" class="nav-link px-0 align-middle text-black">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-grid-3x3-gap" viewBox="0 0 16 16">
                  <path
                    d="M4 2v2H2V2h2zm1 12v-2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V7a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm5 10v-2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V7a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zM9 2v2H7V2h2zm5 0v2h-2V2h2zM4 7v2H2V7h2zm5 0v2H7V7h2zm5 0h-2v2h2V7zM4 12v2H2v-2h2zm5 0v2H7v-2h2zm5 0v2h-2v-2h2zM12 1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zm-1 6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V7zm1 4a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2z" />
                </svg><i class="fs-4 bi-table"></i> <span class="ms-1 d-none d-sm-inline">Quản lí thể
                  loại</span></a>
            </li>
            <li>
              <a href="./static" class="nav-link px-0 align-middle text-blue">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-journals" viewBox="0 0 16 16">
                  <path
                    d="M5 0h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2 2 2 0 0 1-2 2H3a2 2 0 0 1-2-2h1a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1H1a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v9a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1H3a2 2 0 0 1 2-2z" />
                  <path
                    d="M1 6v-.5a.5.5 0 0 1 1 0V6h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V9h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 2.5v.5H.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1H2v-.5a.5.5 0 0 0-1 0z" />
                </svg><i class="fs-4 bi-table"></i> <span class="ms-1 d-none d-sm-inline">Báo
                  cáo</span></a>
            </li>
          </ul>
          <hr>
        </div>
      </div>
      <div class="col py-3">
        <p style="font-size: 22px; text-align: center;"> THỐNG KÊ DOANH THU </p>
        <div class="container text-center">
          <div class="row align-items-start">
            <div class="col">
              <button onclick="day()" class="border border-warning p-2 mb-3">Doanh thu(theo ngày)
              </button>
            </div>
            <div class="col">
              <button onclick="month()" class="border border-secondary p-2 mb-2">Doanh thu (theo tháng)
              </button>
            </div>
          </div>
        </div>
        <div class="container text-center">
          <div class="row align-items-start">
            <div class="col-15">
              <canvas id="revenueMonth" style="width:500px;max-width:1200px"></canvas>
            </div>
            <div class="col-15">
              <canvas id="revenueDay" style="width:500px;max-width:1200px; display:none"></canvas>
            </div>
          </div>
          <p style="font-size: 22px;"> BẢNG XẾP HẠNG SẢN PHẨM </p>
          <div class="row align-items-start">
            <div class="col-4">
              <p style="font-size: 18px; text-align: center;"> THỐNG KÊ TOÀN THỜI GIAN </p>
              <table class="table table-striped table-responsive">
                <thead>
                  <tr>
                    <th scope="col"></th>
                    <th scope="col" style="white-space:nowrap;">Tên sản phẩm </th>
                    <th scope="col" style="white-space:nowrap;">Doanh Thu</th>
                  </tr>
                </thead>
                <tbody>
                  <% var k=sales.length; if(sales.length>= 10) k = 10; %>
                    <%for(var i=0; i < k;i++){%>
                      <tr>
                        <th scope="row">
                          <%=i+1%>
                        </th>
                        <td style="white-space:nowrap;">
                          <%=sales[i].NAMEPRODUCT.length> 10 ? sales[i].NAMEPRODUCT.slice(0, 10) +
                            `...` : sales[i].NAMEPRODUCT%>
                        </td>
                        <td>
                          <%=sales[i].mul%>$
                        </td>
                      </tr>
                      <%}%>
                        <tr>
                          <th scope="row">...</th>
                        </tr>
                </tbody>
              </table>
            </div>
            <div class="col-4">
              <p style="font-size: 18px; text-align: center;"> THỐNG KÊ TOÀN THEO NGÀY </p>
              <table class="table table-striped table-responsive">
                <thead>
                  <tr>
                    <th scope="col"></th>
                    <th scope="col" style="white-space:nowrap;">Tên sản phẩm </th>
                    <th scope="col" style="white-space:nowrap;">Doanh Thu</th>
                  </tr>
                </thead>
                <tbody>
                  <% var k=salesDay.length; if(salesDay.length>= 10) k = 10; %>
                    <%for(var i=0; i < k;i++){%>
                      <tr>
                        <th scope="row">
                          <%=i+1%>
                        </th>
                        <td style="white-space:nowrap;">
                          <%=salesDay[i].NAMEPRODUCT.length> 10 ? salesDay[i].NAMEPRODUCT.slice(0, 10) +
                            `...` : salesDay[i].NAMEPRODUCT%>
                        </td>
                        <td>
                          <%=salesDay[i].mul%>$
                        </td>
                      </tr>
                      <%}%>
                        <tr>
                          <th scope="row">...</th>
                        </tr>
                </tbody>
              </table>
            </div>
            <div class="col-4">
              <p style="font-size: 18px; text-align: center;"> THỐNG KÊ TOÀN THEO THÁNG </p>
              <table class="table table-striped table-responsive">
                <thead>
                  <tr>
                    <th scope="col"></th>
                    <th scope="col" style="white-space:nowrap;">Tên sản phẩm </th>
                    <th scope="col" style="white-space:nowrap;">Doanh Thu</th>
                  </tr>
                </thead>
                <tbody>
                  <% var k=salesMonth.length; if(salesMonth.length>= 10) k = 10; %>
                    <%for(var i=0; i < k;i++){%>
                      <tr>
                        <th scope="row">
                          <%=i+1%>
                        </th>
                        <td style="white-space:nowrap;">
                          <%=salesMonth[i].NAMEPRODUCT.length> 10 ? salesMonth[i].NAMEPRODUCT.slice(0, 10) +
                            `...` : salesMonth[i].NAMEPRODUCT%>
                        </td>
                        <td>
                          <%=salesMonth[i].mul%>$
                        </td>
                      </tr>
                      <%}%>
                        <tr>
                          <th scope="row">...</th>
                        </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
</body>
<script>
  //month
  var revenue1 = parseInt("<%= revenue1[0].sum ? revenue1[0].sum : 0%>");
  var revenue2 = parseInt("<%= revenue2[0].sum ? revenue2[0].sum : 0%>");
  var revenue3 = parseInt("<%= revenue3[0].sum ? revenue3[0].sum : 0%>");
  var revenue4 = parseInt("<%= revenue4[0].sum ? revenue4[0].sum : 0%>");
  var sumMonth = revenue1 + revenue2 + revenue3 + revenue4;
  var revenueMonth_x_Values = ["Tháng 1", "Tháng 4", "Tháng 7", "Tháng 10"];
  var revenueMonth_y_Values = [revenue1, revenue2, revenue3, revenue4];
  //day
  var revenueday1 = parseInt("<%= revenueday1[0].sum ? revenueday1[0].sum : 0%>");
  var revenueday2 = parseInt("<%= revenueday2[0].sum ? revenueday2[0].sum : 0%>");
  var revenueday3 = parseInt("<%= revenueday3[0].sum ? revenueday3[0].sum : 0%>");
  var revenueday4 = parseInt("<%= revenueday4[0].sum ? revenueday4[0].sum : 0%>");
  var sumDay = revenueday1 + revenueday2 + revenueday3 + revenueday4;
  var revenueDay_x_Values = ["<%= revenueday1[0].now.toString().slice(4, 15)%>", "<%= revenueday2[0].now.toString().slice(4, 15)%>", "<%= revenueday3[0].now.toString().slice(4, 15)%>", "<%= revenueday4[0].now.toString().slice(4, 15)%>"];
  var revenueDay_y_Values = [revenueday1, revenueday2, revenueday3, revenueday4];


  new Chart("revenueMonth", {
    type: "line",
    data: {
      labels: revenueMonth_x_Values,
      datasets: [{
        fill: false,
        lineTension: 0,
        backgroundColor: "rgba(0,0,255,1.0)",
        borderColor: "rgba(0,0,255,0.1)",
        data: revenueMonth_y_Values
      }]
    },
    options: {
      legend: { display: false },
      scales: {
        yAxes: [{ ticks: { min: 0, max: parseInt(sumMonth) } }],
      }
    }
  });
  new Chart("revenueDay", {
    type: "line",
    data: {
      labels: revenueDay_x_Values,
      datasets: [{
        fill: false,
        lineTension: 0,
        backgroundColor: "rgba(0,0,255,1.0)",
        borderColor: "rgba(0,0,255,0.1)",
        data: revenueDay_y_Values
      }]
    },
    options: {
      legend: { display: false },
      scales: {
        yAxes: [{ ticks: { min: 0, max: parseInt(sumDay) } }],
      }
    }
  });
  function day() {
    var x = document.getElementById("revenueDay");
    var y = document.getElementById("revenueMonth");
    if (x.style.display === "none") {
      y.style.display = "none";
      x.style.display = "block";
    }
  }
  function month() {
    var x = document.getElementById("revenueMonth");
    var y = document.getElementById("revenueDay");
    if (x.style.display === "none") {
      y.style.display = "none";
      x.style.display = "block";
    }
  }

</script>

</html>